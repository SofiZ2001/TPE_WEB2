------------------PRACTICO 3------------------
------------------VOLUNTARIO------------------
--1 Seleccione el identificador y nombre de todas las instituciones que son Fundaciones.
SELECT id_institucion, nombre_institucion
    FROM institucion
    WHERE nombre_institucion
    LIKE'FUNDACION%';
--5 Muestre el apellido y el identificador de la tarea de todos los voluntarios que no tienen coordinador.
SELECT id_tarea, nombre
    FROM voluntario
    WHERE id_coordinador IS NULL;
--8 Muestre el apellido de los voluntarios cuyas tareas sean "ATENCION DE ROPERITOS" o "ORGANIZACION CAMPAMENTOS RECREATIVOS"
    -- y cuyas horas aportadas no sean iguales a 2.500, 3.500 ni 7.000.
SELECT t1.id_tarea, t1.apellido, t1.horas_aportadas, t2.id_tarea
    FROM voluntario t1
    JOIN tarea t2
    ON (t1.id_tarea = t2.id_tarea)
    WHERE (t2.nombre_tarea = 'ATENCION DE ROPERITOS'
    OR t2.nombre_tarea = 'ORGANIZACION CAMPAMENTOS RECREATIVOS')
    AND t1.horas_aportadas != 2500
    AND t1.horas_aportadas != 3500
    AND t1.horas_aportadas != 7000;
select  v1.id_tarea, v1.apellido, v1.horas_aportadas from tarea t1, voluntario v1
where (v1.horas_aportadas!=2500 and v1.horas_aportadas!= 3500 and v1.horas_aportadas!=7000) and (t1.nombre_tarea ='ATENCION DE ROPERITOS' OR
      t1.nombre_tarea='ORGANIZACION CAMPAMENTOS RECREATIVOS') and (v1.id_tarea = t1.id_tarea);
--ES LO MISMO QUE ESTAS DOS QUERYS
SELECT id_tarea, apellido, horas_aportadas
    FROM voluntario
    WHERE (id_tarea = 'SA_REP'
    OR id_tarea = 'ST_CLERK')
    AND horas_aportadas != 2500
    AND horas_aportadas != 3500
    AND horas_aportadas != 7000;
SELECT *
    FROM tarea
    WHERE nombre_tarea = 'ATENCION DE ROPERITOS'
    OR nombre_tarea = 'ORGANIZACION CAMPAMENTOS RECREATIVOS';
--10 Muestre el apellido, nombre y mail de todos los voluntarios cuyo teléfono comienza con +51. Coloque el encabezado de las columnas de los títulos
    -- 'Apellido y Nombre' y 'Dirección de mail'.
SELECT apellido || ', ' || nombre as "Apellido y Nombre", e_mail as "Direccion de mail"
    FROM voluntario
    WHERE telefono like '+51%';
--12 Recupere la cantidad mínima, máxima y promedio de horas aportadas por los voluntarios nacidos desde 1990.
SELECT min(horas_aportadas), max(horas_aportadas), avg(horas_aportadas)
    FROM voluntario
    WHERE extract(year from fecha_nacimiento) >= 1990;
SELECT t2.min_horas, t2.max_horas,
       t1.horas_aportadas,
       (current_date-t1.fecha_nacimiento) as dif_dias,
       t1.horas_aportadas/(current_date-t1.fecha_nacimiento) as horas_aportadas_x_dia
    FROM voluntario t1
    JOIN tarea t2
    ON(t1.id_tarea = t2.id_tarea)
    WHERE extract(year from fecha_nacimiento) >= 1990; --fecha_nacimiento >= '1990-01-01';
select fecha_nacimiento, current_date-fecha_nacimiento as dif_dias from voluntario;
select current_date;

------------------PELICULA------------------
--2 Seleccione el identificador de distribuidor, identificador de departamento y nombre de todos los departamentos.
SELECT id_distribuidor, id_departamento, nombre
    FROM departamento;
--3 Muestre el nombre, apellido y el teléfono de todos los empleados cuyo id_tarea sea 7231, ordenados por apellido y nombre.
SELECT nombre, apellido, telefono
    FROM empleado
    WHERE id_tarea = '7231'
    ORDER BY apellido, nombre;
--4 Muestre apellido e identificador de todos los empleados que no cobran porcentaje de comisión.
SELECT id_empleado, nombre
    FROM empleado
    WHERE porc_comision IS NULL;
--6 Muestre los datos de los distribuidores internacionales que no tienen registrado teléfono.
SELECT * FROM distribuidor
    WHERE tipo = 'I'
    AND telefono IS NULL;

SELECT t1.id_distribuidor, t1.nombre, t1.direccion, t1.telefono, t1.tipo, t2.codigo_pais
    FROM distribuidor t1, internacional t2
    WHERE t1.tipo = 'I'
    AND telefono IS NULL
    AND t1.id_distribuidor = t2.id_distribuidor;

select  v1.id_tarea, v1.apellido, v1.horas_aportadas from tarea t1, voluntario v1
where (v1.horas_aportadas!=2500 and v1.horas_aportadas!= 3500 and v1.horas_aportadas!=7000) and (t1.nombre_tarea ='ATENCION DE ROPERITOS' OR
      t1.nombre_tarea='ORGANIZACION CAMPAMENTOS RECREATIVOS') and (v1.id_tarea = t1.id_tarea);

--7 Muestre los apellidos, nombres y mails de los empleados con cuentas de gmail y cuyo sueldo sea superior a $ 1000.
SELECT apellido, nombre, e_mail, sueldo
    FROM empleado
    WHERE e_mail
    LIKE '%gmail%'
    AND sueldo > 1000;
--9 Seleccione los diferentes identificadores de tareas que se utilizan en la tabla empleado.
SELECT distinct id_tarea
    FROM empleado ;
--11 Mostrar cumpleaños de todos los empleados con nombre y apellido (concatenados y separados por una coma)
    -- y su fecha de cumpleaños (solo el día y el mes), ordenado de acuerdo al mes y día de cumpleaños en forma ascendente.
SELECT nombre || ', '|| apellido as nombre_apellido,
       (extract(day FROM fecha_nacimiento),
        extract(month FROM fecha_nacimiento)) AS cumpleaños
    FROM empleado
    ORDER BY cumpleaños;
--13 Listar la cantidad de películas que hay por cada idioma
SELECT count(*), idioma
    FROM pelicula
    GROUP BY idioma;
--14 Calcular la cantidad de empleados por departamento.
SELECT id_departamento, count(*) FROM empleado group by id_departamento;
--15 Mostrar los códigos de películas que han recibido entre 3 y 5 entregas.
    -- (cantidad de entregas NO cantidad de películas entregadas)
SELECT codigo_pelicula
    FROM renglon_entrega
    WHERE cantidad between 3 AND 5;